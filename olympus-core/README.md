Core of the API and implementation